<!DOCTYPE html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>寵寵唯跡友善平台</title>
        <link rel="stylesheet" th:href="@{/css/frontend_index_styles.css}">
        <link rel="stylesheet" th:href="@{/slick/slick.css}">
        <link rel="stylesheet" th:href="@{/slick/slick-theme.css}">
        <style type="text/css">.profile-picture {
    width: 30px; /* 調整寬度，例如 50px */
    height: 30px; /* 調整高度，與寬度保持一致 */
    border-radius: 50%; /* 如果需要圓形頭像，保留此屬性 */
    object-fit: cover; /* 確保圖片不會被拉伸 */
}</style>
<!-- <meta name="_csrf" th:content="${_csrf.token}" /> -->
<!-- <meta name="_csrf_header" th:content="${_csrf.headerName}" /> -->

    </head>
    <body>
        <header>
            <h1>
                <a th:href="@{/}">寵寵唯跡 ServPET</a>
            </h1>
        </header>
        
        <nav>
            <div class="dropdown">
                <button class="dropbtn">最新消息</button>
                <div class="dropdown-content">
                    <a th:href="@{/member/event/list}">平台公告消息</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">寵物商城</button>
                <div class="dropdown-content">
                    <a th:href="@{/pdDetails/allProductsHomepage}">商品列表</a>
                    <a th:href="@{/cartDetails/shoppingCart}">購物車</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">寵物美容</button>
                <div class="dropdown-content">
                    <a th:href="@{/pg/showAllPgSvcItem}">寵物美容服務</a>
                    <a th:href="@{/pg}">預約</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">寵物保母</button>
                <div class="dropdown-content">
                    <a th:href="@{/ps/psList}">寵物保母服務</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">會員專區</button>
                <div class="dropdown-content">
                    <a th:href="@{/profile}">會員個人資訊</a>
                    <a th:href="@{/pets}">寵物資訊</a>
                    <a th:href="@{/ntfy/member}">會員訊息匣</a>
                    <a th:href="@{/mebPdo/mebPdo}">商城訂單</a>
                    <a th:href="@{/booking/calendar}">我的寵物美容月曆</a>
                    <a th:href="@{/pdFav/list}">商品收藏</a>
                    <a th:href="@{/pgFav/list}">寵物美容師收藏</a>
                    <a th:href="@{/favorites/psfav}">寵物保母收藏</a>
                    <a th:href="@{/vtr/create}">我的錢包</a>
                    <a th:href="@{/apply/create}">成為美容師/保母</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">聯絡我們</button>
                <div class="dropdown-content">
                    <a th:href="@{/member/cs-issues/add}">問題反應</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">登入</button>
                <div class="dropdown-content">
                    <a th:href="@{/front_end/login}">會員登入</a>
                    <a th:href="@{/back_end/login}">後台登入</a>
                </div>
            </div>
            		<div class="user-info">
            <div class="user-profile">
        <!-- 顯示會員頭像或預設圖片 -->
        <img th:src="${mebImg != null ? 'data:image/png;base64,' + mebImg : '/images/defaultavatar.png'}" 
             alt="會員頭像" 
             class="profile-picture" />
	    </div>
	        <div class="user-actions">
	            <a th:if="${!isLoggedIn}" th:href="@{/front_end/login}">登入</a>
	            <a href="#" onclick="confirmLogout()">會員登出</a> 
	        </div>
	    </div>
        </nav>
        
        <div class="carousel">
            <div class="carousel-slide">
                <a th:href="@{/pdDetails/allProductsHomepage}"><img th:src="@{/images/petsforever.jpg}" alt="Slide 1"></a>
                <a th:href="@{/pg}"><img th:src="@{/images/petgroomer.jpg}" alt="Slide 2"></a>
                <a th:href="@{/ps/psList}"><img th:src="@{/images/petsitter.jpg}" alt="Slide 3"></a>
                <a th:href="@{/ps/psList}"><img th:src="@{/images/petcare.jpg}" alt="Slide 4"></a>
                <a th:href="@{/product}"><img th:src="@{/images/petshop.jpg}" alt="Slide 5"></a>
            </div>
        </div>    
        
        <main>
            <a th:href="@{/pdDetails/allProductsHomepage}" class="section-block">
                <section>
                    <h2>寵物商城</h2>
                    <p>提供琳瑯滿目的寵物用品，無論是營養健康的食品、舒適實用的用品，還是有趣的玩具，一應俱全。讓您的寵物生活更加幸福、便利</p>
                </section>
            </a>
            <a th:href="@{/pg}" class="section-block">
                <section>
                    <h2>寵物美容</h2>
                    <p>專業寵物美容師為您的寵物寶貝提供優質的美容服務，從修剪到清潔，每一個細節都精心呵護，讓寶貝每天都保持帥氣亮眼</p>
                </section>
            </a>
            <a th:href="@{ps/psList}" class="section-block">
                <section>
                    <h2>寵物保母</h2>
                    <p>專業的寵物保母為寵物寶貝提供細心的照顧，無論您外出還是忙碌，都能放心交給我們，讓您的寵物感受到家一般的溫暖陪伴與關愛</p>
                </section>
            </a>
        </main>

        <footer>
            <p>Copyright © 2024 ServPET 寵寵唯跡 All Rights Reserved.</p>
        </footer>

        <script th:src="@{/jquery/jquery-3.7.1.min.js}"></script>
        <script th:src="@{/slick/slick.min.js}"></script>
        <script th:src="@{/javascript/frontend_index_script.js}" defer></script>
    <script>
//     const csrfToken = document.querySelector('meta[name="_csrf"]').content;
//     const csrfHeaderName = document.querySelector('meta[name="_csrf_header"]').content;

    function confirmLogout() {
        const isConfirmed = confirm("您確定要登出嗎？");
        if (isConfirmed) {
            fetch('/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
//                     [csrfHeaderName]: csrfToken // 正確設置 CSRF Header
                }
            })
            .then(response => {
                if (response.ok) {
                    window.location.href = '/'; // 成功登出後重定向至登入頁面
                } else {
                    alert("登出失敗，請稍後再試。");
                }
            })
            .catch(error => {
                console.error("登出請求發生錯誤：", error);
                alert("登出發生錯誤，請稍後再試。");
            });
        }
    }

   </script>
    </body>
</html>
